<!DOCTYPE html>
<html lang="ru" xmlns="http://www.w3.org/1999/xhtml">

<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# place: http://ogp.me/ns/place# restaurant: http://ogp.me/ns/restaurant#">

	<title>Beer</title>

	<link rel="canonical" href="/beer/frame/" />

	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/favicon.ico" />

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />

	<meta name="description" content="Beer of the Irish Pub in Barysaw" />

	<style type="text/css">

		body {
			font-family: 'Open Sans', Arial, sans-serif;
			font-size: 12px;
		}

		* {
			padding: 0;
			margin: 0;
			border: 0;
			transition: all 100ms ease;
		}

		li {
			list-style: none;
		}

		a {
			text-decoration: none;
		}

		a[href]:hover {
			color: #8c8c8c;
		}

		main {
			text-align: center;
		}

		#draft, #other {
			display: inline-grid;
			text-align: left;
			grid-template-columns: 50% 50%;
			padding: 5px;
			width: calc( 100% - 10px );
			max-width: 990px;
		}

		#draft:not( :empty ) {
			border-bottom: 6px #eee dotted;
			padding-bottom: 15px;
			margin-bottom: 15px;
		}

		.beer {
			display: inline-grid;
			border: 1px solid rgba( 0, 0, 0, 0.125 );
			border-radius: 5px;
			margin: 10px;
			grid-template-columns: 85px 1fr;
			grid-template-rows: min-content min-content min-content 1fr;
			padding: 16px;
			width: calc( 100% - 54px );
			overflow: hidden;
		}

		.beer:hover {
			box-shadow: 0 0 8px #dee2e6;
		}

		.logo {
			margin-right: 10px;
			grid-row-start: 1;
			grid-row-end: 5;
		}

		.logo a {
			display: block;
		}

		.logo img {
			width: 100%;
			height: auto;
			object-fit: cover;
		}

		.breweries > * {
			display: inline;
		}

		.brewery a {
			font-weight: 300;
			text-transform: uppercase;
			letter-spacing: 1px;
			font-size: 12px;
		}

		.name {
			padding: 6px 0;
		}

		.name a {
			font-size: 20px;
			font-weight: 700;
			letter-spacing: -0.5px;
			font-family: 'Roboto Condensed', Arial, sans-serif;
			line-height: 1.2;
			color: rgb( 33, 37, 41 );
		}

		.desc > * {
			display: inline-block;
			color: #adb5bd;
			line-height: 1.4;
		}

		.ibu:not( :empty ):before,
		.abv:not( :empty ):before {
			content: '•';
			margin: 0 4px;
		}

		.ibu:not( :empty ):after,
		.abv:not( :empty ):after {
			content: '% abv';
			text-transform: uppercase;
		}

		.ibu:not( :empty ):after {
			content: ' ibu';
		}

		.skus {
			margin-top: 6px;
		}

		.sku:after {
			content: '';
			display: block;
			width: 100%;
			position: absolute;
			border-bottom: 2px dotted #dee2e6;
			bottom: 6px;
			z-index: -1;
		}

		.sku {
			position: relative;
			margin-top: 4px;
		}

		.sku div {
			display: inline-block;
			font-weight: 700;
			background: #fff;
			color: #495057;
		}

		.type {
			padding-right: 4px;
		}

		.price {
			position: absolute;
			right: 0;
			padding-left: 4px;
		}

		.type:not( :empty ):after {
			content: ' l';
		}

		.price:not( :empty ):before {
			content: 'Br ';
		}

		@media ( max-width: 900px )  {

			#draft, #other {
				display: inline-block;
				max-width: 700px;
			}

		}

		main > div {
			display: inline-block;
			text-align: right;
			padding: 20px;
			width: calc( 100% - 40px );
			max-width: 960px;
			font-size: 14px;
		}

		main > div a {
			color: #0066ff;
			text-decoration: underline;
		}

		main > div a[href]:hover {
			color: red;
		}

	</style>

	<template id="beer">
		<li class="beer">
			<a class="logo" target="_blank" rel="noopener noreferrer"></a>
			<ul class="breweries"></ul>
			<h2 class="name"><a target="_blank" rel="noopener noreferrer"></a></h2>
			<div class="desc">
				<a class="style" target="_blank" rel="noopener noreferrer"></a>
				<div class="abv"></div>
				<div class="ibu"></div>
			</div>
			<ul class="skus"></ul>
		</li>
	</template>

	<template id="brewery">
		<li class="brewery"><h3><a target="_blank" rel="noopener noreferrer"></a></h3></li>
	</template>

	<template id="sku">
		<li class="sku">
			<div class="type"></div>
			<div class="price"></div>
		</li>
	</template>

</head>

<body itemscope itemtype="http://schema.org/WebPage">

<main>
	<div>Меню предоставлено <a href="https://catalog.pivo.by/place/irish-pub" target="_blank" rel="noopener noreferrer">Pivo.by</a></div>
	<ul id="draft"></ul>
	<ul id="other"></ul>
</main>

<script>!function( window ) {

	var updateSize = function() {
		var height = document.body.scrollHeight;
		if ( height < 800 ) height = 800;
		setAttribute( window.frameElement, 'height', height );
	};

	/** @noinline */
	var querySelector = function( node, selector ) { return node.querySelector( selector ) };
	/** @noinline */
	var cloneNode = function( node ) { return document.importNode( node.content, true ) };
	/** @noinline */
	var appendChild = function( node, child ) { node.appendChild( child ) };
	/** @noinline */
	var setAttribute = function( node, key, value ) { node.setAttribute( key, value || key ) };

	var document = window.document;

	var xhr = new ( window.XDomainRequest || window.XMLHttpRequest )();

	xhr.open( 'GET', 'https://catalog.pivo.by/api/v1/places/irish-pub', true );

	if ( xhr.overrideMimeType ) xhr.overrideMimeType( 'application/json' );

	xhr.onerror = function() {

		// TODO

	};

	xhr.onload = function() {

		/**
		 * @typedef {{
		 * 		id: number,
		 * 		slug: string,
		 * 		name: string,
		 * 		breweries: Array<{
		 * 			id: number,
		 *			name: string,
		 * 		}>,
		 * 		logo_image: string,
		 * 		beer_style: {
		 * 			slug: string,
		 * 			name: string,
		 * 		},
		 * 		gravity: null,
		 * 		abv: number,
		 * 		ibu: number,
		 * 		avg_rating: number,
		 * 		date_start: string,
		 * 		is_checked: boolean,
		 * 		skus: Array<{
		 * 		    price: number,
		 * 		    volume: string,
		 * 		    packing: string,
		 * 		}>,
		 * 		sale_data: {
		 * 			tap_number: string,
		 * 			start_sales_at: string,
		 * 			shop_price: boolean,
		 * 		},
		 * }} Beer
		 */

		/** @type {{ tap: Array<Beer>, other: Array<Beer>}} */
		var beers = window.JSON.parse( xhr.responseText ).beers;

		var beerTemplate = querySelector( document, '#beer' );
		var breweryTemplate = querySelector( document, '#brewery' );
		var skuTemplate = querySelector( document, '#sku' );

		/**
		 * @param {number} value
		 * @returns {string}
		 */
		var toNumber = function( value ) {
			return window.String( value || 0 ).replace( '.', ',' );
		};

		/**
		 * @param {HTMLElement} slot
		 * @param {Array<Beer>} beers
		 * @returns {HTMLElement}
		 */
		var buildBeers = function( slot, beers ) {

			var i, l, j, m;

			var beer, beerNode, beerLogo, beerLogoIMG, beerName, beerNameA, beerBreweries, beerStyle, beerABV, beerIBU;
			var brewery, breweryNode, breweryName;
			var sku, skuNode, skuType, skuPrice;

			i = 0; l = beers.length;
			for ( ; i<l; ++i ) {

				beer = beers[ i ];
				beerNode = cloneNode( beerTemplate );

				beerBreweries = querySelector( beerNode, '.breweries' );
				beerLogo = querySelector( beerNode, '.logo' );
				beerName = querySelector( beerNode, '.name' );
				beerStyle = querySelector( beerNode, '.style' );
				beerABV = querySelector( beerNode, '.abv' );
				beerIBU = querySelector( beerNode, '.ibu' );

				beerNameA = querySelector( beerName, 'a' );

				j = 0; m = beer.breweries.length;
				for ( ; j<m; ++j ) {

					brewery = beer.breweries[ j ];
					breweryNode = cloneNode( breweryTemplate );

					breweryName = querySelector( breweryNode, 'a' );

					if ( brewery.slug ) setAttribute( breweryName, 'href', '//catalog.pivo.by/brewery/' + brewery.slug );
					if ( brewery.name ) breweryName.textContent = brewery.name;

					appendChild( beerBreweries, breweryNode );

				}

				if ( beer.logo_image ) {
					beerLogoIMG = document.createElement( 'img' );
					setAttribute( beerLogoIMG, 'src', beer.logo_image );
					appendChild( beerLogo, beerLogoIMG );
				}
				if ( beer.slug ) {
					setAttribute( beerLogo, 'href', '//catalog.pivo.by/beer/' + beer.slug );
					setAttribute( beerNameA, 'href', '//catalog.pivo.by/beer/' + beer.slug );
				}
				if ( beer.name ) beerNameA.textContent = beer.name;
				if ( beer.beer_style ) {
					if ( beer.beer_style.slug ) setAttribute( beerStyle, 'href', '//catalog.pivo.by/beers/' + beer.beer_style.slug );
					if ( beer.beer_style.name ) beerStyle.textContent = beer.beer_style.name;
				}
				if ( beer.abv ) beerABV.textContent = toNumber( beer.abv );
				if ( beer.ibu ) beerIBU.textContent = toNumber( beer.ibu );

				j = 0; m = beer.skus.length;
				for ( ; j<m; ++j ) {

					sku = beer.skus[ j ];
					skuNode = cloneNode( skuTemplate );

					skuType = querySelector( skuNode, '.type' );
					skuPrice = querySelector( skuNode, '.price' );

					if ( sku.volume ) skuType.textContent = toNumber( sku.volume );
					if ( sku.price ) skuPrice.textContent = toNumber( sku.price );

					appendChild( querySelector( beerNode, '.skus' ), skuNode );

				}

				appendChild( slot, beerNode );


			}

		};

		buildBeers( querySelector( document, '#draft' ), beers.tap );
		buildBeers( querySelector( document, '#other' ), beers.other );

		updateSize();

	};

	xhr.send();

	window.addEventListener( 'resize', updateSize );
	window.addEventListener( 'DOMContentLoaded', updateSize );

}( this )</script>

<link href="//fonts.googleapis.com/css?family=Open+Sans|Roboto+Condensed&display=swap" rel="stylesheet" type="text/css" />

</body>

</html>